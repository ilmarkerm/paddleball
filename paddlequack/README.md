# Paddlequack

This package writes JSON format output, generated by paddleball, to DuckDB database for analytics.

## Usage

Pipe paddleball client mode JSON output to paddlequack.

```
paddleball -j -e -r 50 -n 2 127.0.0.1:12234 | paddlequack -f testresult.duckdb -r
```

## Reporting

-r flag will output some very basic regular reporting. But the idea behind this package is to save all results in DuckDB database for after test reporting.

One good way for accessing the measurements is to install DuckDB CLI:
https://duckdb.org/docs/api/cli/overview.html

There is only one table inside the database, and that table is called paddleball. It contains all the measurements. You can run SQL queries against that table.

```
$ duckdb testresult.duckdb 
v1.1.3 19864453f7
Enter ".help" for usage hints.
D show tables;
┌────────────┐
│    name    │
│  varchar   │
├────────────┤
│ paddleball │
└────────────┘
D desc paddleball;
┌───────────────────────┬──────────────────────────┬─────────┬─────────┬─────────┬─────────┐
│      column_name      │       column_type        │  null   │   key   │ default │  extra  │
│        varchar        │         varchar          │ varchar │ varchar │ varchar │ varchar │
├───────────────────────┼──────────────────────────┼─────────┼─────────┼─────────┼─────────┤
│ EventTime             │ TIMESTAMP WITH TIME ZONE │ NO      │         │         │         │
│ Tag                   │ VARCHAR                  │ NO      │         │         │         │
│ ReceivedPackets       │ BIGINT                   │ NO      │         │         │         │
│ DroppedPackets        │ BIGINT                   │ NO      │         │         │         │
│ DuplicatePackets      │ BIGINT                   │ NO      │         │         │         │
│ ReorderedPackets      │ BIGINT                   │ NO      │         │         │         │
│ AverageRTT            │ DOUBLE                   │ NO      │         │         │         │
│ LowestRTT             │ DOUBLE                   │ NO      │         │         │         │
│ HighestRTT            │ DOUBLE                   │ NO      │         │         │         │
│ P90RTT                │ DOUBLE                   │ YES     │         │         │         │
│ P99RTT                │ DOUBLE                   │ YES     │         │         │         │
│ PBQueueDroppedPackets │ BIGINT                   │ NO      │         │         │         │
│ PBQueueLength         │ INTEGER                  │ NO      │         │         │         │
│ PBQueueCapacity       │ INTEGER                  │ NO      │         │         │         │
├───────────────────────┴──────────────────────────┴─────────┴─────────┴─────────┴─────────┤
│ 14 rows                                                                        6 columns │
└──────────────────────────────────────────────────────────────────────────────────────────┘

D select max(HighestRTT) from paddleball where EventTime > now() - interval '1 hour';
┌─────────────────┐
│ max(HighestRTT) │
│     double      │
├─────────────────┤
│       10.149701 │
└─────────────────┘
```
